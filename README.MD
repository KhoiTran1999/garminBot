# ðŸƒâ€â™‚ï¸ Garmin AI Coach Pro (Notion Integrated)

**Trá»£ lÃ½ áº£o Huáº¥n luyá»‡n viÃªn cháº¡y bá»™ cÃ¡ nhÃ¢n hÃ³a, sá»­ dá»¥ng dá»¯ liá»‡u Garmin, Google Gemini AI vÃ  quáº£n lÃ½ qua Notion.**

Dá»± Ã¡n nÃ y tá»± Ä‘á»™ng hÃ³a quy trÃ¬nh thu tháº­p dá»¯ liá»‡u sá»©c khá»e tá»« Garmin Connect, tÃ­nh toÃ¡n cÃ¡c chá»‰ sá»‘ chuyÃªn sÃ¢u (Training Readiness, TRIMP), káº¿t há»£p vá»›i **ngá»¯ cáº£nh cÃ¡ nhÃ¢n tá»« Notion** (Má»¥c tiÃªu, Cháº¥n thÆ°Æ¡ng) Ä‘á»ƒ Ä‘Æ°a ra lá»i khuyÃªn táº­p luyá»‡n hÃ ng ngÃ y qua Telegram.

## âœ¨ TÃ­nh nÄƒng ná»•i báº­t

*   **ðŸ§  Notion Database Integration:**
    *   Quáº£n lÃ½ danh sÃ¡ch ngÆ°á»i dÃ¹ng, máº­t kháº©u vÃ  tráº¡ng thÃ¡i Active trá»±c quan trÃªn Notion.
    *   **CÃ¡ nhÃ¢n hÃ³a theo thá»i gian thá»±c:** Cáº­p nháº­t "Má»¥c tiÃªu" hoáº·c "TÃ¬nh tráº¡ng cháº¥n thÆ°Æ¡ng" trÃªn Notion, AI sáº½ tá»± Ä‘á»™ng Ä‘iá»u chá»‰nh giÃ¡o Ã¡n ngay láº­p tá»©c.

*   **ðŸ“Š PhÃ¢n tÃ­ch Dá»¯ liá»‡u ChuyÃªn sÃ¢u:**
    *   **Giáº¥c ngá»§:** PhÃ¢n tÃ­ch chi tiáº¿t 3 giai Ä‘oáº¡n (Deep, Light, REM) vÃ  thá»i gian ngá»§ thá»±c táº¿ (trá»« lÃºc tá»‰nh giáº¥c).
    *   **Training Readiness:** TÃ­nh Ä‘iá»ƒm sáºµn sÃ ng dá»±a trÃªn Pin cÆ¡ thá»ƒ (Body Battery), Stress vÃ  Giáº¥c ngá»§.
    *   **Acute Training Load (7 ngÃ y):** TÃ­nh toÃ¡n táº£i táº­p luyá»‡n dá»±a trÃªn nhá»‹p tim (TRIMP Banister).

*   **ðŸ¤– AI Coach (Gemini 2.0 Flash):** 
    *   ÄÃ³ng vai HLV chuyÃªn nghiá»‡p, Ä‘Æ°a ra bÃ i táº­p cá»¥ thá»ƒ (Pace, Thá»i gian) dá»±a trÃªn thá»ƒ tráº¡ng thá»±c táº¿.
    *   Tá»± Ä‘á»™ng táº¡o **Voice Script** (Text-to-Speech) Ä‘á»ƒ gá»­i lá»i nháº¯n Ä‘á»™ng viÃªn báº±ng giá»ng nÃ³i.

*   **ðŸ“² Telegram Bot:**
    *   **Morning Report (7:30 AM):** PhÃ¢n tÃ­ch giáº¥c ngá»§ vÃ  lá»i khuyÃªn Ä‘áº§u ngÃ y.
    *   **Training Report (5:00 PM):** Gá»­i giÃ¡o Ã¡n chi tiáº¿t vÃ  phÃ¢n tÃ­ch táº£i lÆ°á»£ng váº­n Ä‘á»™ng.

*   **â˜ï¸ Tá»± Ä‘á»™ng hÃ³a 100%:** Cháº¡y miá»…n phÃ­ trÃªn GitHub Actions.

## ðŸ› ï¸ YÃªu cáº§u chuáº©n bá»‹

Äá»ƒ cháº¡y dá»± Ã¡n, báº¡n cáº§n:

1.  **TÃ i khoáº£n Garmin Connect:** Email vÃ  Máº­t kháº©u.
2.  **Google Gemini API Key:** Láº¥y miá»…n phÃ­ táº¡i [Google AI Studio](https://aistudio.google.com/).
3.  **Telegram Bot:** Token vÃ  Chat ID (láº¥y tá»« @BotFather vÃ  @userinfobot).
4.  **Notion Integration:**
    *   Táº¡o Database trÃªn Notion.
    *   Láº¥y `NOTION_TOKEN` vÃ  `NOTION_DATABASE_ID`.

## ðŸ—‚ï¸ Cáº¥u trÃºc Database trÃªn Notion

Báº¡n cáº§n táº¡o má»™t Database (Full page) trÃªn Notion vá»›i cÃ¡c cá»™t chÃ­nh xÃ¡c nhÆ° sau Ä‘á»ƒ Code hoáº¡t Ä‘á»™ng:

| TÃªn Cá»™t (Property)          | Loáº¡i (Type) | MÃ´ táº£                                                 |
| --------------------------- | ----------- | ----------------------------------------------------- |
| **Name**                    | Title       | TÃªn hiá»ƒn thá»‹ cá»§a VÄV.                                 |
| **Email**                   | Email       | Email Ä‘Äƒng nháº­p Garmin.                               |
| **Password**                | Text        | Máº­t kháº©u Garmin.                                      |
| **Telegram Chat ID**        | Text        | ID chat Telegram (Dáº¡ng Text Ä‘á»ƒ trÃ¡nh lá»—i format sá»‘).  |
| **Training Goal**           | Text        | VD: "Marathon Sub 4", "Cháº¡y dÆ°á»¡ng sinh".              |
| **Cháº¥n thÆ°Æ¡ng & Bá»‡nh táº­t**  | Text        | VD: "Äau gá»‘i pháº£i", "Äang á»‘m".                        |
| **Ghi chÃº**                 | Text        | Ghi chÃº thÃªm cho AI.                                  |
| **Active**                  | Checkbox    | Tick âœ… Ä‘á»ƒ báº­t Bot cho user nÃ y.                        |

> **LÆ°u Ã½:** Sau khi táº¡o Database, hÃ£y nhá»› cáº¥p quyá»n cho Bot truy cáº­p báº±ng cÃ¡ch báº¥m vÃ o `...` > `Connections` > `Connect to` > Chá»n Integration cá»§a báº¡n.

## ðŸš€ CÃ i Ä‘áº·t & Cháº¡y (Local)

1.  **Clone repository:**
    ```bash
    git clone https://github.com/khoitran1999/garminbot.git
    cd garminbot
    ```

2.  **CÃ i Ä‘áº·t thÆ° viá»‡n:**
    ```bash
    pip install -r requirements.txt
    ```
    *(Äáº£m báº£o Ä‘Ã£ cÃ³ `notion-client` vÃ  `garminconnect` báº£n má»›i nháº¥t)*.

3.  **Cáº¥u hÃ¬nh biáº¿n mÃ´i trÆ°á»ng:**
    Táº¡o file `.env` vá»›i ná»™i dung:
    ```env
    TELEGRAM_TOKEN="your_tele_token"
    GEMINI_API_KEY="your_gemini_key"
    NOTION_TOKEN="secret_your_notion_token"
    NOTION_DATABASE_ID="your_database_id"
    ```

4.  **Cháº¡y thá»­ nghiá»‡m:**
    *   Cháº¡y Bot chÃ­nh (Cháº¿ Ä‘á»™ Daily): 
        ```bash
        python main.py --mode daily
        ```
    *   Cháº¡y Bot Sleep Analysis (Cháº¿ Ä‘á»™ Sleep): 
        ```bash
        python main.py --mode sleep_analysis
        ```
    *   Cháº¡y Bot Sleep Analysis (Cháº¿ Ä‘á»™ Sleep): 
        ```bash
        python main.py --mode sleep_analysis
        ```

## âš™ï¸ Triá»ƒn khai trÃªn GitHub Actions

Báº¡n khÃ´ng cáº§n server riÃªng, Bot sáº½ cháº¡y tá»± Ä‘á»™ng trÃªn GitHub.

1.  **Fork** dá»± Ã¡n nÃ y vá» GitHub cá»§a báº¡n.
2.  VÃ o **Settings** > **Secrets and variables** > **Actions**.
3.  ThÃªm cÃ¡c **Repository secrets** sau (Láº¥y giÃ¡ trá»‹ tá»« file `.env` cá»§a báº¡n):
    *   `TELEGRAM_TOKEN`
    *   `GEMINI_API_KEY`
    *   `NOTION_TOKEN`
    *   `NOTION_DATABASE_ID`

4.  GitHub Actions sáº½ tá»± Ä‘á»™ng cháº¡y theo lá»‹ch:
    *   **Sleep Analysis:** 07:30 (Giá» VN).
    *   **Daily Report:** 17:00 (Giá» VN).

## ðŸ“‚ Cáº¥u trÃºc dá»± Ã¡n

*   `app/services/`: Chá»©a cÃ¡c module xá»­ lÃ½ logic chÃ­nh.
    *   `ai_service.py`: TÆ°Æ¡ng tÃ¡c vá»›i Google Gemini.
    *   `garmin_service.py`: Láº¥y vÃ  xá»­ lÃ½ dá»¯ liá»‡u Garmin.
    *   `notion_service.py`: Káº¿t ná»‘i Notion DB.
    *   `telegram_service.py`: Gá»­i tin nháº¯n vÃ  Voice.
*   `main.py`: Entry point chÃ­nh (Garmin Login -> Data -> AI -> Telegram).

*   `.github/workflows/`: Cáº¥u hÃ¬nh lá»‹ch cháº¡y tá»± Ä‘á»™ng.

---

**Author:** [Tráº§n Quá»‘c KhÃ´i]